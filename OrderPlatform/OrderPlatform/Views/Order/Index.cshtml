@model IEnumerable<OrderPlatform.Models.OrderIndexModel>

@{
    ViewBag.Title = "Orders";
}

<h2>Orders</h2>

<div id="chartContainer" style="height: 370px; width: 100%;"></div>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

<div>
    <a class="btn btn-primary" href="~/Order/Edit/0" role="button">Create new order</a>
</div>

<br />

<table class="table table-bordered table-responsive table-condensed">
    <thead>
        <tr class="btn-primary">
            <th>@Html.DisplayNameFor(m => m.id)</th>
            <th>@Html.DisplayNameFor(m => m.date)</th>
            <th>@Html.DisplayNameFor(m => m.username)</th>
            <th>@Html.DisplayNameFor(m => m.state)</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var m in Model)
        {
            <tr>
                <td>@m.id</td>
                <td>@m.date</td>
                <td>@m.username</td>
                <td>@m.state</td>
                <td><a href="~/Order/Edit/@m.id">Edit</a></td>
                <td><a href="~/Order/Delete/@m.id" onclick="return confirm('Are you sure you want to delete this record?')">Delete</a></td> @*//onlick is a javascript event that in this case triggers a popup choice of confirmation//*@
            </tr>
        }
    </tbody>
</table>

<script>
    window.onload = function () {

        var chart = new CanvasJS.Chart("chartContainer", {
            animationEnabled: true,
            title: {
                text: "Database Data"
            },
            data: [{
                type: "pie",
                startAngle: 240,
                yValueFormatString: "##0.00\"%\"",
                indexLabel: "{label} {y}",
                dataPoints: [
                    { y: @ViewBag.quantitiesList[0], label: "Orders", color: "#0275d8" },
                    { y: @ViewBag.quantitiesList[3], label: "Products", color: "#f0ad4e" },
                    { y: @ViewBag.quantitiesList[2], label: "States", color: "#d9534f" },
                    { y: @ViewBag.quantitiesList[4], label: "Warehouses", color: "#5cb85c" },
                    { y: @ViewBag.quantitiesList[1], label: "Users", color: "#5bc0de" }
                ]
            }]
        });
        chart.render();

    }
</script>